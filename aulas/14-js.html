<div id="root"></div>

<script src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/prop-types@15.6.2/prop-types.js"></script>
<script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.2.2/vanilla-tilt.babel.min.js"></script>

<script type = "text/babel">

  const getErrorMessage = (value) => {
    if(value.length < 3) {return `Username deve ter no mínimo 3 caracteres`}
    if(!value.includes('p'))
      return `Você precisa ter um "p" no seu username para fazer parte da psopciepdapde`
    return null
  }
  class NameForm extends React.Component{
    state = {
      error: this.props.getErrorMessage('')
      // error: false
    }

    handleChange = (event) => {
      const {value} = event.target
      this.setState({error: this.props.getErrorMessage(value)})
    }

    handleSubmit = (event) => {
      event.preventDefault()
      const valor = this.batatinha.value
      const erro = this.props.getErrorMessage(valor)
      if(erro) alert(`Deu ruim aí: ${erro}`)
      else alert(`xuxessu: ${valor}`)
    }

    render() {
      const {error} = this.state
      return (
        <form onSubmit={this.handleSubmit}>
          <label>
            Name:
            <input type="text"
              ref={node => this.batatinha = node }
              name= "username"
              onChange={this.handleChange}
            />
          </label>
          {error && <div style ={{color: 'red'}}>{error}</div>}
          <button disabled={Boolean(error)} type = "submit"> Submit</button>
        </form>
      )
    }
  }
  const element = <NameForm
    getErrorMessage = {getErrorMessage}
  />
  ReactDOM.render(element, document.getElementById('root'))

</script>